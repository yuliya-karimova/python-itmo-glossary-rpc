# Отчет: Реализация графа терминов с использованием gRPC и Protocol Buffers

## Описание проекта

Данный проект реализует gRPC-сервис для работы с графом терминов глоссария. Сервис позволяет:

- Получать информацию о терминах
- Получать список всех терминов
- Находить связи между терминами
- Искать пути между терминами в графе

Проект использует:
- **gRPC** для межпроцессного взаимодействия
- **Protocol Buffers (protobuf)** для сериализации данных
- **Python** для реализации сервера и клиента

## Структура проекта

```
python-itmo-glossary-rpc/
├── protobufs/
│   ├── glossary.proto          # Определение gRPC сервиса и сообщений
│   └── recommendations.proto    # Пример из предыдущего задания
├── glossary_server.py           # Реализация gRPC сервера
├── glossary_client.py           # Клиент для тестирования сервиса
├── glossary_pb2.py              # Сгенерированные классы protobuf
├── glossary_pb2_grpc.py         # Сгенерированные gRPC классы
├── terms.csv                    # Файл с терминами (название, определение)
├── links.csv                    # Файл со связями между терминами
├── requirements.txt             # Зависимости проекта
└── REPORT.md                    # Этот отчет
```

## Структура данных

### terms.csv
Файл содержит термины и их определения:
```csv
term,definition
Подход к разработке интерфейса,"Набор принципов и практик..."
Backend-Driven UI,"Модель, где структура экрана..."
...
```

### links.csv
Файл содержит связи между терминами в формате:
```csv
source,target,relation
Подход к разработке интерфейса,Классическая разработка UI,включает подход
Backend-Driven UI,Серверная модель экрана,опирается на
...
```

## Определение Protocol Buffers

Файл `protobufs/glossary.proto` определяет структуру данных и сервис:

### Основные сообщения:
- `Term` - информация о термине (название, определение)
- `Relation` - связь между терминами (источник, цель, тип связи)
- `TermRequest` - запрос на получение термина
- `RelationsRequest` - запрос на получение связей
- `PathRequest` - запрос на поиск пути между терминами

### Сервис `GlossaryService`:
- `GetTerm` - получить информацию о термине
- `GetAllTerms` - получить все термины
- `GetTermRelations` - получить связи термина
- `FindPath` - найти путь между двумя терминами

## Процесс развертывания

### 1. Установка зависимостей

Убедитесь, что установлены необходимые пакеты:

```bash
pip install grpcio grpcio-tools
```

Или используйте файл `requirements.txt`:

```bash
pip install -r requirements.txt
```

### 2. Генерация Python кода из .proto файлов

Сгенерируйте Python классы из proto-файла:

```bash
python -m grpc_tools.protoc -I./protobufs \
    --python_out=. \
    --pyi_out=. \
    --grpc_python_out=. \
    ./protobufs/glossary.proto
```

Эта команда создаст файлы:
- `glossary_pb2.py` - классы для сообщений protobuf
- `glossary_pb2.pyi` - типы для статической проверки
- `glossary_pb2_grpc.py` - классы для gRPC сервиса и клиента

### 3. Подготовка данных

Убедитесь, что файлы `terms.csv` и `links.csv` находятся в корневой директории проекта.

### 4. Запуск сервера

Запустите gRPC сервер:

```bash
python3 glossary_server.py
```

Вывод должен выглядеть так:
```
Загружено терминов: 19
Загружено связей: 26
Glossary gRPC сервер запущен, слушает порт 50052
Загружено терминов: 19
Загружено связей: 26
```

Сервер будет работать на порту **50052**.

### 5. Запуск клиента (в другом терминале)

В новом терминале запустите клиент для тестирования:

```bash
python3 glossary_client.py
```

## Демонстрация работы сервиса

### Пример 1: Получение всех терминов

**Запрос:**
```python
response = stub.GetAllTerms(empty_pb2.Empty())
```

**Ответ:**
```
Всего терминов: 19
Первые 5 терминов:
  1. Подход к разработке интерфейса
  2. Классическая разработка UI
  3. Backend-Driven UI
  4. Архитектура клиента
  5. Контракт API
```

### Пример 2: Получение информации о термине

**Запрос:**
```python
request = TermRequest(term_name="Backend-Driven UI")
response = stub.GetTerm(request)
```

**Ответ:**
```
Термин: Backend-Driven UI
Определение: Модель, где структура экрана и поведение частично задаются сервером и интерпретируются клиентом, ускоряя доставку изменений.
```

### Пример 3: Получение связей термина

**Запрос:**
```python
request = RelationsRequest(term_name="Backend-Driven UI", max_depth=1)
response = stub.GetTermRelations(request)
```

**Ответ:**
```
Термин: Backend-Driven UI
Всего связей: 13
Связи:
  Backend-Driven UI --[опирается на]--> Серверная модель экрана
  Backend-Driven UI --[формализует через]--> Описание UI (схема)
  Backend-Driven UI --[исполняется в]--> Интерпретатор UI
  ...
```

### Пример 4: Поиск пути между терминами

**Запрос:**
```python
request = PathRequest(
    source_term="Подход к разработке интерфейса",
    target_term="Интерпретатор UI",
    max_depth=10
)
response = stub.FindPath(request)
```

**Ответ:**
```
Путь от 'Подход к разработке интерфейса' к 'Интерпретатор UI':
Подход к разработке интерфейса -> Backend-Driven UI -> Интерпретатор UI
```

## Архитектура решения

### Серверная часть (`glossary_server.py`)

1. **Класс `GlossaryGraph`**:
   - Загружает данные из CSV файлов
   - Строит граф терминов (ориентированный)
   - Предоставляет методы для работы с графом:
     - `get_term()` - получение термина
     - `get_all_terms()` - получение всех терминов
     - `get_term_relations()` - получение связей
     - `find_path()` - поиск пути (BFS алгоритм)

2. **Класс `GlossaryService`**:
   - Реализует интерфейс `GlossaryServiceServicer`
   - Преобразует запросы gRPC в вызовы методов `GlossaryGraph`
   - Возвращает ответы в формате protobuf

3. **Функция `serve()`**:
   - Создает экземпляр `GlossaryGraph`
   - Инициализирует gRPC сервер
   - Запускает сервер на порту 50052

### Клиентская часть (`glossary_client.py`)

Клиент демонстрирует различные операции:
- Подключение к серверу
- Вызов всех методов сервиса
- Обработка ошибок
- Вывод результатов

## Особенности реализации

### Поиск пути (BFS)

Для поиска пути между терминами используется алгоритм **BFS (Breadth-First Search)**, который:
- Находит кратчайший путь
- Учитывает как прямые, так и обратные связи в графе
- Ограничен максимальной глубиной поиска

### Двунаправленный граф

Граф хранит как прямые связи (`graph`), так и обратные (`reverse_graph`), что позволяет:
- Быстро находить входящие связи термина
- Эффективно искать пути в обоих направлениях

## Преимущества использования gRPC

1. **Производительность**: Бинарная сериализация protobuf быстрее JSON
2. **Типобезопасность**: Строгая типизация через .proto файлы
3. **Кросс-языковая совместимость**: Легко портировать на другие языки
4. **Четкий контракт API**: .proto файл служит документацией API
5. **HTTP/2**: Поддержка потоков и мультиплексирования

## Тестирование

Для тестирования сервиса выполните:

1. Запустите сервер:
   ```bash
   python3 glossary_server.py
   ```

2. В другом терминале запустите клиент:
   ```bash
   python3 glossary_client.py
   ```

3. Клиент автоматически выполнит все примеры использования

## Заключение

Проект успешно демонстрирует:
- Использование Protocol Buffers для определения структуры данных
- Создание gRPC сервиса на Python
- Работу с графовыми структурами данных
- Сериализацию и десериализацию данных через protobuf
- Межпроцессное взаимодействие через gRPC

Все компоненты работают совместно, обеспечивая эффективный API для работы с графом терминов глоссария.
